(function(t){function a(a){for(var n,r,l=a[0],c=a[1],s=a[2],f=0,d=[];f<l.length;f++)r=l[f],i[r]&&d.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(a);while(d.length)d.shift()();return o.push.apply(o,s||[]),e()}function e(){for(var t,a=0;a<o.length;a++){for(var e=o[a],n=!0,l=1;l<e.length;l++){var c=e[l];0!==i[c]&&(n=!1)}n&&(o.splice(a--,1),t=r(r.s=e[0]))}return t}var n={},i={app:0},o=[];function r(a){if(n[a])return n[a].exports;var e=n[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=n,r.d=function(t,a,e){r.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,a){if(1&a&&(t=r(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)r.d(e,n,function(a){return t[a]}.bind(null,n));return e},r.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(a,"a",a),a},r.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},r.p="/itaria/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=a,l=l.slice();for(var s=0;s<l.length;s++)a(l[s]);var u=c;o.push([0,"chunk-vendors"]),e()})({0:function(t,a,e){t.exports=e("56d7")},5490:function(t,a,e){"use strict";var n=e("bdf3"),i=e.n(n);i.a},"56d7":function(t,a,e){"use strict";e.r(a);e("cadf"),e("551c"),e("f751"),e("097d");var n=e("2b0e"),i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"content"},[e("Map",{attrs:{id:"map",air_quality:this.airQuality}})],1),e("div",{staticClass:"bottom-control"},[e("div",{staticClass:"indicator"},[e("v-date-picker",{attrs:{locale:"custom","available-dates":this.availableDates},model:{value:t.selectedDate,callback:function(a){t.selectedDate=a},expression:"selectedDate"}},[e("b-icon",{attrs:{icon:"calendar",size:"small"}})],1)],1),e("div",{staticClass:"indicator"},[e("b-select",{attrs:{placeholder:"Selezione un parametro",rounded:"",size:"is-small"},model:{value:t.indicator,callback:function(a){t.indicator=a},expression:"indicator"}},t._l(t.indicators,function(a){return e("option",{key:t.indicators.indexOf(a),domProps:{value:a}},[t._v("\n            "+t._s(a)+"\n          ")])}),0)],1),e("div",{staticClass:"indicator legend"},t._l(t.legendMap,function(a){return e("div",{key:t.legendMap.indexOf(a),style:{color:a.color}},[0==t.legendMap.indexOf(a)?e("b-icon",{attrs:{icon:"help-circle",size:"is-small"}}):e("b-icon",{attrs:{icon:"checkbox-blank-circle",size:"is-small"}})],1)}),0)])])},o=[],r=(e("ac6a"),e("28a5"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"map"},[null!=this.showInfo?e("b-message",{staticClass:"val-detail",attrs:{type:"is-info","has-icon":"",size:"is-medium"}},[e("strong",[t._v(t._s(t.showInfo.name))]),t._v("\n    "+t._s(t.showInfo.value)+" µg/m³\n  ")]):t._e(),e("div",{ref:"mapEl",staticClass:"map-container box"})],1)}),l=[],c=(e("7f7f"),e("6e58")),s=(e("88c2"),e("bc3a")),u=e.n(s),f="https://gist.githubusercontent.com/n28div/db0b258e697c12dd2f0900e569d1fe02/raw/d487214b16ff2a011e32b386f1ae0a26858ca996/italy-provinces-geojson.json",d={name:"Map",components:{},props:["air_quality"],data:function(){return{geojson:null,zoom:1500,showInfo:null}},methods:{drawMap:function(){var t=this,a=this.$refs.mapEl;a.innerHTML="";var e=400,n=400,i=c["select"](".map-container").append("svg").attr("preserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 ".concat(e," ").concat(n)).attr("stroke","black").attr("stroke-width","0.3px").classed("map-content",!0);c["json"](f,function(a,o){if(a)return console.log(a);o.features;var r=c["geo"].mercator().translate([e/2,n/2]).scale(t.zoom).center([12,42]),l=c["geo"].path().projection(r);i.append("g").attr("class","tracts").selectAll("path").data(o.features).enter().append("path").attr("d",l).attr("class",function(a){return a.id in t.air_quality?"region quality-".concat(t.air_quality[a.id].quality_index):"region quality-na"}).on("mouseover",function(a,e){var n=t.air_quality[a.id]||null;null!=n&&null!=n.value&&(t.showInfo={name:n.name,value:n.value})}).on("mouseout",function(){return t.showInfo=null})})}},watch:{air_quality:function(t,a){this.drawMap()}}},p=d,h=(e("5490"),e("2877")),v=Object(h["a"])(p,r,l,!1,null,null,null),m=v.exports;function b(t){var a=t.quality["Pm2,5"],e=0;return a>0&&a<10?e=1:a>=10&&a<20?e=2:a>=20&&a<25?e=3:a>=25&&a<50?e=4:a>=50&&(e=5),{name:t.name,short:t.short,value:a,quality_index:e}}function y(t){var a=t.quality["Pm10"],e=0;return a>0&&a<10?e=1:a>=10&&a<20?e=2:a>=20&&a<25?e=3:a>=25&&a<50?e=4:a>=50&&a<800&&(e=5),{name:t.name,short:t.short,value:a,quality_index:e}}function g(t){var a=t.quality["NO2"],e=0;return a>0&&a<40?e=1:a>=40&&a<100?e=2:a>=100&&a<200?e=3:a>=200&&a<400?e=4:a>=400&&(e=5),{name:t.name,short:t.short,value:a,quality_index:e}}function _(t){var a=t.quality["O3"],e=0;return a>0&&a<80?e=1:a>=80&&a<120?e=2:a>=120&&a<180?e=3:a>=180&&a<240?e=4:a>=240&&(e=5),{name:t.name,short:t.short,value:a,quality_index:e}}function w(t){var a=t.quality["SO2"],e=0;return a>0&&a<100?e=1:a>=100&&a<200?e=2:a>=200&&a<350?e=3:a>=350&&a<500?e=4:a>=500&&(e=5),{name:t.name,short:t.short,value:a,quality_index:e}}var D="https://itairq.herokuapp.com/api/v1",x={name:"app",components:{Map:m},data:function(){return{legendMap:[{color:"#dfdfdf",label:"Dato non presente"},{color:"#29b100",label:"Qualità ottima"},{color:"#96f07b",label:"Qualità buona"},{color:"#f0e641",label:"Qualità media"},{color:"#ff5050",label:"Qualità scarsa"},{color:"#960032",label:"Qualità pessima"}],nationalAirQuality:[],indicator:"pm10",indicators:["pm10","pm25","so2","no2","o3"],selectedDate:new Date,availableDates:[],showModal:!1,airQuality:{}}},methods:{formatDate:function(t){var a=t.getDate(),e=t.getMonth()+1,n=t.getFullYear(),i="".concat(n,"/").concat(e,"/").concat(a);return i},parseDate:function(t){var a=t.split("-").map(function(t){return parseInt(t)}),e=new Date(a[0],a[1]-1,a[2]);return e},evaluateAirQuality:function(){var t=null;switch(this.indicator){case"so2":t=w;break;case"no2":t=g;break;case"o3":t=_;break;case"pm25":t=b;break;case"pm10":t=y;break}var a={};this.nationalAirQuality.forEach(function(e){e.provinces.forEach(function(e){a[e.short]=t(e)})}),this.airQuality=a},fetchNationalData:function(){var t=this,a=this.formatDate(this.selectedDate);u.a.get("".concat(D,"/").concat(a)).then(function(a){t.nationalAirQuality=a.data,t.evaluateAirQuality()}).catch(function(t){return console.log(t)})},fetchAvailableDates:function(){var t=this;u.a.get("".concat(D,"/dates")).then(function(a){t.availableDates=a.data.map(function(a){return t.parseDate(a)})}).catch(function(t){return console.log(t)})}},watch:{selectedDate:function(){this.fetchNationalData()},indicator:function(){this.evaluateAirQuality()}},beforeMount:function(){this.fetchAvailableDates(),this.fetchNationalData()}},k=x,M=(e("f423"),Object(h["a"])(k,i,o,!1,null,"91421e7a",null)),q=M.exports,O=e("8a03"),j=e.n(O),Q=(e("5abe"),e("5887")),A=e.n(Q);n["default"].use(j.a),n["default"].use(A.a,{locales:{custom:{firstDayOfWeek:1,masks:{L:"YYYY/MM/DD"}}}}),n["default"].config.productionTip=!1,new n["default"]({render:function(t){return t(q)}}).$mount("#app")},"90fe":function(t,a,e){},bdf3:function(t,a,e){},f423:function(t,a,e){"use strict";var n=e("90fe"),i=e.n(n);i.a}});
//# sourceMappingURL=app.845c8405.js.map